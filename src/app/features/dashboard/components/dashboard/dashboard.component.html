<div
  class="min-h-screen p-5"
  style="background: linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%)"
>
  <!-- ================= HEADER ================= -->
  <div
    class="border-round-2xl p-5 mb-5"
    style="
      background: linear-gradient(135deg, var(--hms-primary-light), #ffffff);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    "
  >
    <div class="flex justify-content-between align-items-center">
      <div>
        <h1 class="text-3xl font-bold text-900 m-0">Dashboard</h1>

        <p class="text-600 mt-2 flex align-items-center">
          Welcome back,
          <span class="font-semibold text-900 capitalize ml-1">
            {{ username }}
          </span>

          <span class="mx-3 text-400">|</span>

          <span
            class="px-3 py-1 border-round-2xl text-sm font-medium"
            style="
              background: rgba(59, 130, 246, 0.1);
              color: var(--hms-primary);
            "
          >
            {{ userRole | titlecase }}
          </span>
        </p>
      </div>

      <!-- <button
        pButton
        pRipple
        icon="pi pi-power-off"
        label="Logout"
        class="p-button-danger p-button-text"
        style="border-radius: 2rem"
        (click)="onLogout()"
        pTooltip="Sign out"
      ></button> -->
    </div>
  </div>

  <!-- ================= STATS ================= -->
  <div class="mb-5">
    <app-stats-cards></app-stats-cards>
  </div>

  <!-- ================= MAIN GRID ================= -->
  <div class="grid">
    <!-- LEFT SECTION -->
    <div class="col-12 xl:col-8">
      <!-- Doctor Widget -->
      <div *ngIf="userRole === 'Doctor'" class="mb-5">
        <app-card
          styleClass="border-round-2xl overflow-hidden"
          style="
            background: #ffffff;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
          "
        >
          <div
            class="flex justify-content-between align-items-center px-4 py-3 border-bottom-1 surface-border"
          >
            <h5 class="text-xl font-semibold m-0 text-900">
              My Upcoming Appointments
            </h5>

            <button
              pButton
              label="View All"
              icon="pi pi-arrow-right"
              class="p-button-text"
              routerLink="/appointments"
            ></button>
          </div>

          <p-table
            [value]="myAppointments"
            styleClass="p-datatable-sm"
            [tableStyle]="{ 'min-width': '100%' }"
          >
            <ng-template pTemplate="header">
              <tr class="text-600 text-sm">
                <th class="px-4 py-3">Patient</th>
                <th class="px-4 py-3">Time</th>
                <th class="px-4 py-3">Status</th>
                <th class="px-4 py-3 text-center">Action</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-appt>
              <tr
                class="transition-all transition-duration-200"
                style="cursor: pointer"
              >
                <td class="px-4 py-3 font-semibold text-900">
                  {{ appt.patientName }}
                </td>

                <td class="px-4 py-3 text-600">
                  {{ appt.date | date: 'shortTime' }}
                </td>

                <td class="px-4 py-3">
                  <app-status-badge [status]="appt.status"></app-status-badge>
                </td>

                <td class="px-4 py-3 text-center">
                  <button
                    pButton
                    icon="pi pi-play"
                    class="p-button-rounded p-button-success p-button-text"
                    style="width: 2.5rem; height: 2.5rem"
                    pTooltip="Start Consultation"
                    routerLink="/consultation/by-appointment/{{ appt.id }}"
                  ></button>
                </td>
              </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="4" class="text-center py-5 text-500">
                  No upcoming appointments.
                </td>
              </tr>
            </ng-template>
          </p-table>
        </app-card>
      </div>

      <!-- Non Doctor -->
      <app-today-activity *ngIf="userRole !== 'Doctor'"></app-today-activity>
    </div>

    <!-- RIGHT SECTION -->
    <div class="col-12 xl:col-4">
      <div
        class="border-round-2xl p-4 h-full"
        style="background: #ffffff; box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06)"
      >
        <div class="flex align-items-center justify-content-between mb-4">
          <h5 class="text-xl font-semibold text-900 m-0">Quick Actions</h5>
          <i class="pi pi-bolt text-yellow-500 text-xl"></i>
        </div>

        <div class="flex flex-column gap-3">
          <button
            pButton
            pRipple
            *appHasPermission="permissions.CMP_PATIENT_ADD"
            label="New Patient"
            icon="pi pi-user-plus"
            class="p-button-outlined w-full justify-content-between"
            style="border-radius: 1rem"
          ></button>

          <button
            pButton
            pRipple
            *appHasPermission="permissions.MOD_APPOINTMENTS"
            label="Book Appointment"
            icon="pi pi-calendar-plus"
            class="p-button-outlined w-full justify-content-between"
            style="border-radius: 1rem"
          ></button>

          <button
            pButton
            pRipple
            *appHasPermission="permissions.MOD_LAB"
            label="View Reports"
            icon="pi pi-file"
            class="p-button-outlined w-full justify-content-between"
            style="border-radius: 1rem"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>
