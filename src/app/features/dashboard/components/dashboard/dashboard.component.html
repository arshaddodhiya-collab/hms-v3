<div class="p-4 bg-gray-50 min-h-screen">
  <!-- Header Section -->
  <div class="flex justify-content-between align-items-center mb-5">
    <div>
      <h1 class="text-3xl font-bold text-900 m-0">Dashboard</h1>
      <p class="text-500 mt-2">
        Welcome back,
        <span class="font-bold text-700 capitalize">{{ username }}</span>
        <span class="text-400 mx-2">|</span>
        <span
          class="inline-block px-2 py-1 border-round text-sm font-medium"
          style="
            background-color: var(--hms-primary-light);
            color: var(--hms-primary);
          "
          >{{ userRole | titlecase }}</span
        >
      </p>
    </div>
    <button
      pButton
      pRipple
      label="Logout"
      icon="pi pi-power-off"
      class="p-button-danger p-button-text hover:bg-red-50"
      (click)="onLogout()"
      pTooltip="Sign out of the system"
      tooltipPosition="bottom"
    ></button>
  </div>

  <!-- Dynamic Stats -->
  <div class="mb-5">
    <app-stats-cards></app-stats-cards>
  </div>

  <!-- Two Column Layout for Activity and Charts (Chart placeholder) -->
  <div class="grid">
    <div class="col-12 xl:col-8">
      <!-- <div class="surface-card shadow-2 border-round p-4 h-full"> -->
      <!-- <h5 class="text-xl font-bold text-900 mb-4">Today's Activity</h5> -->
      <!-- Doctor's Specific Widget -->
      <div class="mb-5" *ngIf="userRole === 'Doctor'">
        <app-card>
          <div class="flex justify-content-between align-items-center mb-3">
            <h5 class="text-xl font-bold m-0 text-900">
              My Upcoming Appointments
            </h5>
            <button
              pButton
              label="View All"
              class="p-button-text"
              routerLink="/appointments"
            ></button>
          </div>
          <p-table
            [value]="myAppointments"
            [tableStyle]="{ 'min-width': '100%' }"
          >
            <ng-template pTemplate="header">
              <tr>
                <th>Patient</th>
                <th>Time</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-appt>
              <tr>
                <td class="font-bold">{{ appt.patientName }}</td>
                <td>{{ appt.date | date: 'shortTime' }}</td>
                <td>
                  <app-status-badge [status]="appt.status"></app-status-badge>
                </td>
                <td>
                  <button
                    pButton
                    icon="pi pi-play"
                    class="p-button-rounded p-button-success p-button-text"
                    pTooltip="Start Consultation"
                    routerLink="/consultation/{{ appt.id }}"
                  ></button>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="4">No upcoming appointments.</td>
              </tr>
            </ng-template>
          </p-table>
        </app-card>
      </div>

      <app-today-activity *ngIf="userRole !== 'Doctor'"></app-today-activity>
      <!-- </div> -->
    </div>
    <div class="col-12 xl:col-4">
      <div class="surface-card shadow-2 border-round p-4 h-full">
        <div class="flex align-items-center justify-content-between mb-4">
          <h5 class="text-xl font-bold text-900 m-0">Quick Actions</h5>
          <i class="pi pi-bolt text-yellow-500 text-xl"></i>
        </div>

        <div class="flex flex-column gap-3">
          <button
            pButton
            pRipple
            *appHasPermission="permissions.CMP_PATIENT_ADD"
            label="New Patient"
            icon="pi pi-user-plus"
            class="p-button-outlined p-button-secondary w-full text-left justify-content-between"
            pTooltip="Register a new patient"
            tooltipPosition="left"
          ></button>
          <button
            pButton
            pRipple
            *appHasPermission="permissions.MOD_APPOINTMENTS"
            label="Book Appointment"
            icon="pi pi-calendar-plus"
            class="p-button-outlined p-button-secondary w-full text-left justify-content-between"
            pTooltip="Schedule a new appointment"
            tooltipPosition="left"
          ></button>
          <button
            pButton
            pRipple
            *appHasPermission="permissions.MOD_LAB"
            label="View Reports"
            icon="pi pi-file"
            class="p-button-outlined p-button-secondary w-full text-left justify-content-between"
            pTooltip="View laboratory reports"
            tooltipPosition="left"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>
