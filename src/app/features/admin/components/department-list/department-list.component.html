<div class="card">
  <app-page-header title="Departments" icon="pi pi-building">
    <button
      pButton
      label="Add Department"
      icon="pi pi-plus"
      (click)="createDepartment()"
      *appHasPermission="permissions.CMP_ADMIN_DEPT_WRITE"
    ></button>
  </app-page-header>

  <app-table
    [data]="departments"
    [columns]="cols"
    [globalFilterFields]="['name', 'head']"
    [actionsTemplate]="actions"
  >
  </app-table>

  <ng-template #actions let-dept>
    <ng-container *appHasPermission="permissions.CMP_ADMIN_DEPT_WRITE">
      <button
        pButton
        icon="pi pi-pencil"
        class="p-button-rounded p-button-text p-button-warning mr-2"
        (click)="editDepartment(dept)"
        pTooltip="Edit"
      ></button>
      <button
        pButton
        icon="pi pi-trash"
        class="p-button-rounded p-button-text p-button-danger"
        (click)="deleteDepartment(dept.id)"
        pTooltip="Delete"
      ></button>
    </ng-container>
  </ng-template>

  <app-confirm-dialog
    [(isOpen)]="isConfirmOpen"
    title="Delete Department"
    message="Are you sure you want to delete this department?"
    (confirm)="onConfirmDelete()"
    (cancel)="onCancelDelete()"
  ></app-confirm-dialog>

  <p-dialog
    [(visible)]="displayDialog"
    [header]="dialogHeader"
    [modal]="true"
    [style]="{ width: '50vw' }"
    [draggable]="false"
    [resizable]="false"
  >
    <app-department-create
      [deptToEdit]="selectedDept"
      (save)="onSave($event)"
      (cancel)="onCancel()"
    >
    </app-department-create>
  </p-dialog>
</div>
