<app-card styleClass="p-0">
  <app-page-header title="Appointments" icon="pi pi-calendar">
    <button
      *appHasPermission="permissions.CMP_APPOINTMENT_CREATE"
      pButton
      pRipple
      label="New Appointment"
      icon="pi pi-plus"
      class="p-button-primary"
      (click)="openNew('New Appointment')"
      pTooltip="Schedule a new appointment"
      tooltipPosition="bottom"
    ></button>
  </app-page-header>

  <app-table [data]="data" [columns]="cols" [actionsTemplate]="actions">
  </app-table>
</app-card>

<ng-template #statusTemplate let-value>
  <app-status-badge
    [status]="value"
    [type]="
      value === 'CONFIRMED'
        ? 'success'
        : value === 'CHECKED_IN'
          ? 'warning'
          : value === 'COMPLETED'
            ? 'success'
            : value === 'CANCELLED'
              ? 'error'
              : 'info'
    "
  >
  </app-status-badge>
</ng-template>

<ng-template #actions let-appointment>
  <div class="flex justify-content-center">
    <ng-container
      *ngIf="
        appointment.status === 'SCHEDULED' || appointment.status === 'CONFIRMED'
      "
    >
      <button
        *appHasPermission="permissions.CMP_APPOINTMENT_EDIT"
        pButton
        pRipple
        icon="pi pi-check-circle"
        aria-label="Check In"
        class="p-button-rounded p-button-text p-button-success mr-2"
        (click)="onCheckIn(appointment)"
        pTooltip="Check In Patient"
        tooltipPosition="top"
      ></button>
    </ng-container>

    <button
      pButton
      pRipple
      icon="pi pi-eye"
      aria-label="View Details"
      class="p-button-rounded p-button-text p-button-info mr-2"
      [routerLink]="[appointment.id]"
      pTooltip="View Details"
      tooltipPosition="top"
    ></button>
    <button
      *appHasPermission="permissions.CMP_APPOINTMENT_EDIT"
      pButton
      pRipple
      icon="pi pi-pencil"
      aria-label="Edit Appointment"
      class="p-button-rounded p-button-text p-button-warning"
      (click)="editItem(appointment, 'Edit Appointment')"
      pTooltip="Edit Appointment"
      tooltipPosition="top"
    ></button>
  </div>
</ng-template>
